<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Figures 5, 6, and S4 â€¢ curatedTCGAManu</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Figures 5, 6, and S4">
<meta property="og:description" content="curatedTCGAManu">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">curatedTCGAManu</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/Figure2_OncoPrint.html">PanCan OncoPrint</a>
</li>
<li>
  <a href="../articles/Figures3n4_GSEA_PanCan.html">PanCan DE &amp; GSEA</a>
</li>
<li>
  <a href="../articles/Figures5-6-S4.html">Multi-omic Plots</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/LiNk-NY/curatedTCGAManu/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Figures 5, 6, and S4</h1>
                        <h4 class="author">Waldron Lab</h4>
            
            <h4 class="date">May 07, 2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/LiNk-NY/curatedTCGAManu/blob/master/vignettes/Figures5-6-S4.Rmd"><code>vignettes/Figures5-6-S4.Rmd</code></a></small>
      <div class="hidden name"><code>Figures5-6-S4.Rmd</code></div>

    </div>

    
    
<p>Load packages:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">MultiAssayExperiment</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">curatedTCGAData</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">RColorBrewer</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">TCGAutils</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">survival</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggpubr</span>)</pre></body></html></div>
<div id="using-acc" class="section level1">
<h1 class="hasAnchor">
<a href="#using-acc" class="anchor"></a>Using ACC</h1>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">acc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/curatedTCGAData/man/curatedTCGAData.html">curatedTCGAData</a></span>(<span class="st">"ACC"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"RNASeq2GeneNorm"</span>, <span class="st">"GISTIC_T*"</span>), <span class="fl">FALSE</span>)</pre></body></html></div>
<div id="example-multivariate-cox-regression-with-rnaseq-expression-copy-number-and-pathology" class="section level2">
<h2 class="hasAnchor">
<a href="#example-multivariate-cox-regression-with-rnaseq-expression-copy-number-and-pathology" class="anchor"></a>Example: Multivariate Cox regression with RNASeq expression, copy number, and pathology</h2>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">wideacc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MultiAssayExperiment/man/MultiAssayExperiment-helpers.html">wideFormat</a></span>(<span class="no">acc</span>[<span class="st">"EZH2"</span>, , ],
    <span class="kw">colDataCols</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"vital_status"</span>, <span class="st">"days_to_death"</span>, <span class="st">"pathology_N_stage"</span>))
<span class="no">wideacc</span><span class="kw">[[</span><span class="st">"y"</span>]] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span>(<span class="no">wideacc</span>$<span class="no">days_to_death</span>, <span class="no">wideacc</span>$<span class="no">vital_status</span>)
<span class="no">wideacc</span></pre></body></html></div>
<pre><code>## DataFrame with 92 rows and 7 columns
##          primary vital_status days_to_death pathology_N_stage
##      &lt;character&gt;    &lt;integer&gt;     &lt;integer&gt;       &lt;character&gt;
## 1   TCGA-OR-A5J1            1          1355                n0
## 2   TCGA-OR-A5J2            1          1677                n0
## 3   TCGA-OR-A5J3            0            NA                n0
## 4   TCGA-OR-A5J4            1           423                n1
## 5   TCGA-OR-A5J5            1           365                n0
## ...          ...          ...           ...               ...
## 88  TCGA-PK-A5H9            0            NA                n0
## 89  TCGA-PK-A5HA            0            NA                n0
## 90  TCGA-PK-A5HB            0            NA                NA
## 91  TCGA-PK-A5HC            0            NA                n0
## 92  TCGA-P6-A5OG            1           383                n0
##     ACC_GISTIC_ThresholdedByGene.20160128_EZH2
##                                      &lt;numeric&gt;
## 1                                            0
## 2                                            1
## 3                                            1
## 4                                           -2
## 5                                            1
## ...                                        ...
## 88                                           0
## 89                                           0
## 90                                           0
## 91                                           1
## 92                                           0
##     ACC_RNASeq2GeneNorm.20160128_EZH2      y
##                             &lt;numeric&gt; &lt;Surv&gt;
## 1                             75.8886 1355:1
## 2                            326.5332 1677:1
## 3                            190.1940   NA:0
## 4                                  NA  423:1
## 5                            366.3826  365:1
## ...                               ...    ...
## 88                             47.806   NA:0
## 89                            118.523   NA:0
## 90                            390.136   NA:0
## 91                                 NA   NA:0
## 92                            684.872  383:1</code></pre>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html">coxph</a></span>(
    <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span>(<span class="no">days_to_death</span>, <span class="no">vital_status</span>) ~ <span class="no">`ACC_GISTIC_ThresholdedByGene.20160128_EZH2`</span> +
        <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">`ACC_RNASeq2GeneNorm.20160128_EZH2`</span>) + <span class="no">pathology_N_stage</span>,
    <span class="kw">data</span><span class="kw">=</span><span class="no">wideacc</span>
)</pre></body></html></div>
<pre><code>## Call:
## coxph(formula = Surv(days_to_death, vital_status) ~ ACC_GISTIC_ThresholdedByGene.20160128_EZH2 + 
##     log2(ACC_RNASeq2GeneNorm.20160128_EZH2) + pathology_N_stage, 
##     data = wideacc)
## 
##                                                coef exp(coef) se(coef)      z
## ACC_GISTIC_ThresholdedByGene.20160128_EZH2 -0.03723   0.96345  0.28205 -0.132
## log2(ACC_RNASeq2GeneNorm.20160128_EZH2)     0.97731   2.65729  0.28105  3.477
## pathology_N_stagen1                         0.37749   1.45862  0.56992  0.662
##                                                   p
## ACC_GISTIC_ThresholdedByGene.20160128_EZH2 0.894986
## log2(ACC_RNASeq2GeneNorm.20160128_EZH2)    0.000506
## pathology_N_stagen1                        0.507743
## 
## Likelihood ratio test=16.28  on 3 df, p=0.0009942
## n= 26, number of events= 26 
##    (66 observations deleted due to missingness)</code></pre>
</div>
<div id="example-correlation-between-rnaseq-expression-and-copy-number" class="section level2">
<h2 class="hasAnchor">
<a href="#example-correlation-between-rnaseq-expression-and-copy-number" class="anchor"></a>Example: Correlation between RNASeq expression and copy number</h2>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">subacc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MultiAssayExperiment/man/MultiAssayExperiment-helpers.html">intersectColumns</a></span>(<span class="no">acc</span>)
<span class="no">subacc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MultiAssayExperiment/man/MultiAssayExperiment-helpers.html">intersectRows</a></span>(<span class="no">subacc</span>)</pre></body></html></div>
<p>Create a list of numeric matrices:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">acc.mats</span> <span class="kw">&lt;-</span> <span class="fu">assays</span>(<span class="no">subacc</span>)</pre></body></html></div>
<p>Log-transform the RNA-seq assay:</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">acc.mats</span><span class="kw">[[</span><span class="st">"ACC_RNASeq2GeneNorm-20160128"</span>]] <span class="kw">&lt;-</span>
    <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">acc.mats</span><span class="kw">[[</span><span class="st">"ACC_RNASeq2GeneNorm-20160128"</span>]] + <span class="fl">1</span>)</pre></body></html></div>
<p>Transpose both, so genes are in columns:</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">subacc.list</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">acc.mats</span>, <span class="no">t</span>)</pre></body></html></div>
<p>Calculate the correlation between columns in the first matrix and columns in the second matrix:</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">corres</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(<span class="no">subacc.list</span><span class="kw">[[</span><span class="fl">1</span>]], <span class="no">subacc.list</span><span class="kw">[[</span><span class="fl">2</span>]])</pre></body></html></div>
<pre><code>## Warning in cor(subacc.list[[1]], subacc.list[[2]]): the standard deviation is
## zero</code></pre>
<p>And finally, create the histogram:</p>
</div>
<div id="figure-5" class="section level2">
<h2 class="hasAnchor">
<a href="#figure-5" class="anchor"></a>Figure 5</h2>
<div id="histogram-of-the-distribution-of-pearson-correlation-coefficients-between-gene-copy-number-and-rna-seq-gene-expression-in-adrenocortical-carcinoma-acc" class="section level3">
<h3 class="hasAnchor">
<a href="#histogram-of-the-distribution-of-pearson-correlation-coefficients-between-gene-copy-number-and-rna-seq-gene-expression-in-adrenocortical-carcinoma-acc" class="anchor"></a>Histogram of the distribution of Pearson correlation coefficients between gene copy number and RNA-seq gene expression in adrenocortical carcinoma (ACC)</h3>
<p>Histogram of the distribution of Pearson correlation coefficients between RNA-Seq and copy number alteration in adrenocortical carcinoma (ACC). An integrative representaiton readily allows comparison and correlation of multi-omics experiments.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">diagvals</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="no">corres</span>)
<span class="no">diagframe</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">genename</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">diagvals</span>), <span class="kw">value</span> <span class="kw">=</span> <span class="no">diagvals</span>)

<span class="no">jco</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ggpubr/man/get_palette.html">get_palette</a></span>(<span class="kw">palette</span> <span class="kw">=</span> <span class="st">"jco"</span>, <span class="fl">1</span>)

<span class="fu"><a href="https://rdrr.io/pkg/ggpubr/man/gghistogram.html">gghistogram</a></span>(<span class="no">diagframe</span>, <span class="kw">x</span> <span class="kw">=</span> <span class="st">"value"</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="no">jco</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="no">jco</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"Frequency"</span>,
    <span class="kw">xlab</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Pearson coefficient ("</span>, <span class="no">rho</span>, <span class="st">")"</span>)), <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.25</span>,
    <span class="kw">ggtheme</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>(), <span class="kw">rug</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">bins</span> <span class="kw">=</span> <span class="fl">45</span>, <span class="kw">add</span> <span class="kw">=</span> <span class="st">"mean"</span>)</pre></body></html></div>
<p><img src="Figures5-6-S4_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>Code for saving as PDF:</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="co"># png("F5_rnaseq-cn-correl_ggpubr.png", width = 8, height = 6, units = "in",</span>
<span class="co">#    res = 300)</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html">pdf</a></span>(<span class="st">"F5_rnaseq-cn-correl_ggpubr.pdf"</span>, <span class="kw">width</span> <span class="kw">=</span> <span class="fl">8</span>, <span class="kw">height</span> <span class="kw">=</span> <span class="fl">6</span>, <span class="kw">paper</span> <span class="kw">=</span> <span class="st">"special"</span>)

<span class="fu"><a href="https://rdrr.io/pkg/ggpubr/man/gghistogram.html">gghistogram</a></span>(<span class="no">diagframe</span>, <span class="kw">x</span> <span class="kw">=</span> <span class="st">"value"</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="no">jco</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="no">jco</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"Frequency"</span>,
    <span class="kw">xlab</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Pearson coefficient ("</span>, <span class="no">rho</span>, <span class="st">")"</span>)), <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.25</span>,
    <span class="kw">ggtheme</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>(), <span class="kw">rug</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">bins</span> <span class="kw">=</span> <span class="fl">45</span>, <span class="kw">add</span> <span class="kw">=</span> <span class="st">"mean"</span>)

<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span>()</pre></body></html></div>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">corres</span>[<span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html">upper.tri</a></span>(<span class="no">corres</span>)])</pre></body></html></div>
<p><img src="Figures5-6-S4_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
</div>
<div id="figure-6" class="section level2">
<h2 class="hasAnchor">
<a href="#figure-6" class="anchor"></a>Figure 6</h2>
<div id="violin-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#violin-plots" class="anchor"></a>Violin plots</h3>
<p>Log 2 expression values by copy number alteration for the highly correlated SNRPB2 gene in adrenocortical carcinoma tumors. Violin plots show differences in expression by copy number loss or gain of SNRPB2, the gene with the highest corration of expression to copy number values (0.83). Copy number increases as log 2 expression values also increase.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r">(<span class="no">topvals</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="no">corres</span>)), <span class="kw">decreasing</span> <span class="kw">=</span> <span class="fl">TRUE</span>)))</pre></body></html></div>
<pre><code>##    SNRPB2     NAA20    CRNKL1      BAG5    POLR2C     UBOX5 
## 0.8289331 0.8046060 0.8038552 0.7997314 0.7910225 0.7866916</code></pre>
<p>The â€˜SNRPB2â€™ gene expression has a correlation to CNV = 0.83</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="no">snr</span> <span class="kw">&lt;-</span> <span class="no">subacc</span>[<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">topvals</span>)[<span class="fl">1L</span>], ]</pre></body></html></div>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="no">snpexp</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/MultiAssayExperiment/man/MultiAssayExperiment-helpers.html">wideFormat</a></span>(<span class="no">snr</span>, <span class="kw">check.names</span> <span class="kw">=</span> <span class="fl">FALSE</span>))
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">snpexp</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"primary"</span>, <span class="st">"CopyNumber"</span>, <span class="st">"Expression"</span>)
<span class="co">## remove outlier in CN</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">snpexp</span>$<span class="no">CopyNumber</span>)</pre></body></html></div>
<pre><code>## 
## -2 -1  0  1 
##  1  9 29 38</code></pre>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="no">snpexp</span> <span class="kw">&lt;-</span> <span class="no">snpexp</span>[<span class="no">snpexp</span>$<span class="no">CopyNumber</span> <span class="kw">!=</span> -<span class="fl">2</span>, ]

<span class="no">snpexp</span><span class="kw">[[</span><span class="st">"Log2Exp"</span>]] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="no">snpexp</span><span class="kw">[[</span><span class="st">"Expression"</span>]], <span class="fl">2</span>)
<span class="no">snpexp</span>$<span class="no">CopyNumber</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">snpexp</span>$<span class="no">CopyNumber</span>)

<span class="no">jcols</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ggpubr/man/get_palette.html">get_palette</a></span>(<span class="kw">palette</span> <span class="kw">=</span> <span class="st">"jco"</span>, <span class="fl">4</span>)
<span class="no">jcols</span> <span class="kw">&lt;-</span> <span class="no">jcols</span>[<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">4</span>)]

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">snpexp</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">CopyNumber</span>, <span class="no">Log2Exp</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="no">CopyNumber</span>)) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span>(<span class="kw">trim</span> <span class="kw">=</span> <span class="fl">FALSE</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span>(<span class="st">"Copy Number"</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span>(<span class="st">"log2(expression)"</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span>(<span class="kw">width</span><span class="kw">=</span><span class="fl">0.2</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="st">"white"</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span>(<span class="kw">values</span> <span class="kw">=</span> <span class="no">jcols</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()</pre></body></html></div>
<p><img src="Figures5-6-S4_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>Code for saving as PDF:</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="co"># png("violin_exp.png", width = 8, height = 6, units = "in", res = 300)</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html">pdf</a></span>(<span class="st">"F6_violin_exp.pdf"</span>, <span class="kw">width</span> <span class="kw">=</span> <span class="fl">8</span>, <span class="kw">height</span> <span class="kw">=</span> <span class="fl">6</span>, <span class="kw">paper</span> <span class="kw">=</span> <span class="st">"special"</span>)

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">snpexp</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">CopyNumber</span>, <span class="no">Log2Exp</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="no">CopyNumber</span>)) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span>(<span class="kw">trim</span> <span class="kw">=</span> <span class="fl">FALSE</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span>(<span class="st">"Copy Number"</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span>(<span class="st">"log2(expression)"</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span>(<span class="kw">width</span><span class="kw">=</span><span class="fl">0.2</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="st">"white"</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span>(<span class="kw">values</span> <span class="kw">=</span> <span class="no">jcols</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()

<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span>()</pre></body></html></div>
</div>
</div>
<div id="supplemental-figure-4" class="section level2">
<h2 class="hasAnchor">
<a href="#supplemental-figure-4" class="anchor"></a>Supplemental Figure 4</h2>
<div id="identifying-correlated-principal-components" class="section level3">
<h3 class="hasAnchor">
<a href="#identifying-correlated-principal-components" class="anchor"></a>Identifying correlated principal components</h3>
<p>Correlated Principal Components across experimental assays in Adrenocortical carcinoma (ACC) from The Cancer Genome Atlas (TCGA). Plot identifies correlated principal components across protein, GISTIC copy number, microRNA, mutation, and RNA-Seq assays obtained from curatedTCGAData. The RNA-Seq PC is consistently correlated with protein arrays, GISTIC, and miRNA.</p>
<p>Perform Principal Components Analysis of each of the five assays, using samples available on each assay, log-transforming RNA-seq data first. Using the first 10 components, calculate Pearson correlation between all scores and plot these correlations as a heatmap to identify correlated components across assays.</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="no">acc_full</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/curatedTCGAData/man/curatedTCGAData.html">curatedTCGAData</a></span>(<span class="st">"ACC"</span>,
    <span class="kw">assays</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"RNASeq2*"</span>, <span class="st">"GISTIC_T*"</span>, <span class="st">"RPPA*"</span>, <span class="st">"Mutation"</span>, <span class="st">"miRNASeqGene"</span>),
    <span class="kw">dry.run</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="no">acc_full</span></pre></body></html></div>
<pre><code>## A MultiAssayExperiment object of 5 listed
##  experiments with user-defined names and respective classes.
##  Containing an ExperimentList class object of length 5:
##  [1] ACC_GISTIC_ThresholdedByGene-20160128: SummarizedExperiment with 24776 rows and 90 columns
##  [2] ACC_miRNASeqGene-20160128: SummarizedExperiment with 1046 rows and 80 columns
##  [3] ACC_Mutation-20160128: RaggedExperiment with 20166 rows and 90 columns
##  [4] ACC_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 79 columns
##  [5] ACC_RPPAArray-20160128: SummarizedExperiment with 192 rows and 46 columns
## Features:
##  experiments() - obtain the ExperimentList instance
##  colData() - the primary/phenotype DataFrame
##  sampleMap() - the sample availability DFrame
##  `$`, `[`, `[[` - extract colData columns, subset, or experiment
##  *Format() - convert into a long or wide DataFrame
##  assays() - convert ExperimentList to a SimpleList of matrices</code></pre>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="no">getLoadings</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>, <span class="no">ncomp</span><span class="kw">=</span><span class="fl">10</span>, <span class="no">dolog</span><span class="kw">=</span><span class="fl">FALSE</span>, <span class="no">center</span><span class="kw">=</span><span class="fl">TRUE</span>, <span class="no">scale.</span><span class="kw">=</span><span class="fl">TRUE</span>) {
    <span class="kw">if</span> (<span class="no">dolog</span>){
        <span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">x</span> + <span class="fl">1</span>)
    }
    <span class="no">pc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span>(<span class="no">x</span>, <span class="kw">center</span><span class="kw">=</span><span class="no">center</span>, <span class="kw">scale.</span><span class="kw">=</span><span class="no">scale.</span>)
    <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">pc</span>$<span class="no">rotation</span>[, <span class="fl">1</span>:<span class="fl">10</span>])
}</pre></body></html></div>
<p>Take only samples that match accross assays:</p>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="no">acc2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MultiAssayExperiment/man/MultiAssayExperiment-helpers.html">intersectColumns</a></span>(<span class="no">acc_full</span>)</pre></body></html></div>
<p>Categorize by silent mutations:</p>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="no">mut</span> <span class="kw">&lt;-</span> <span class="fu">assay</span>(<span class="no">acc2</span><span class="kw">[[</span><span class="st">"ACC_Mutation-20160128"</span>]], <span class="kw">i</span> <span class="kw">=</span> <span class="st">"Variant_Classification"</span>)
<span class="no">mut</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">mut</span>) <span class="kw">|</span> <span class="no">mut</span> <span class="kw">==</span> <span class="st">"Silent"</span>, <span class="fl">0</span>, <span class="fl">1</span>)
<span class="no">acc2</span><span class="kw">[[</span><span class="st">"ACC_Mutation-20160128"</span>]] <span class="kw">&lt;-</span> <span class="no">mut</span></pre></body></html></div>
<p>Add loadings as a separate assay for each:</p>
<div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="no">acc2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">acc2</span>,
    <span class="kw">`RNA-Seq`</span> <span class="kw">=</span> <span class="fu">getLoadings</span>(<span class="fu">assays</span>(<span class="no">acc2</span>)<span class="kw">[[</span><span class="st">"ACC_RNASeq2GeneNorm-20160128"</span>]],
        <span class="kw">dolog</span><span class="kw">=</span><span class="fl">TRUE</span>), <span class="kw">mapFrom</span><span class="kw">=</span><span class="fl">1L</span>
    )
<span class="no">acc2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">acc2</span>,
    <span class="kw">`GISTIC-T`</span> <span class="kw">=</span> <span class="fu">getLoadings</span>(<span class="fu">assays</span>(<span class="no">acc2</span>)<span class="kw">[[</span><span class="st">"ACC_GISTIC_ThresholdedByGene-20160128"</span>]],
        <span class="kw">center</span><span class="kw">=</span><span class="fl">FALSE</span>, <span class="kw">scale.</span><span class="kw">=</span><span class="fl">FALSE</span>), <span class="kw">mapFrom</span><span class="kw">=</span><span class="fl">2L</span>)
<span class="no">acc2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">acc2</span>,
    <span class="kw">Protein</span> <span class="kw">=</span> <span class="fu">getLoadings</span>(<span class="fu">assays</span>(<span class="no">acc2</span>)<span class="kw">[[</span><span class="st">"ACC_RPPAArray-20160128"</span>]]),
        <span class="kw">mapFrom</span><span class="kw">=</span><span class="fl">3L</span>)
<span class="no">acc2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">acc2</span>,
    <span class="kw">Mutations</span> <span class="kw">=</span> <span class="fu">getLoadings</span>(<span class="fu">assays</span>(<span class="no">acc2</span>)<span class="kw">[[</span><span class="st">"ACC_Mutation-20160128"</span>]],
        <span class="kw">center</span><span class="kw">=</span><span class="fl">FALSE</span>, <span class="kw">scale.</span><span class="kw">=</span><span class="fl">FALSE</span>), <span class="kw">mapFrom</span><span class="kw">=</span><span class="fl">4L</span>)
<span class="no">acc2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">acc2</span>,
    <span class="kw">miRNA</span> <span class="kw">=</span> <span class="fu">getLoadings</span>(<span class="fu">assays</span>(<span class="no">acc2</span>)<span class="kw">[[</span><span class="st">"ACC_miRNASeqGene-20160128"</span>]]),
        <span class="kw">mapFrom</span><span class="kw">=</span><span class="fl">5L</span>)</pre></body></html></div>
<p>Now subset to keep <em>only</em> the PCA results:</p>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="no">acc2</span> <span class="kw">&lt;-</span> <span class="no">acc2</span>[, , <span class="fl">6</span>:<span class="fl">10</span>]</pre></body></html></div>
<pre><code>## harmonizing input:
##   removing 215 sampleMap rows not in names(experiments)</code></pre>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/MultiAssayExperiment/man/MultiAssayExperiment-methods.html">experiments</a></span>(<span class="no">acc2</span>)</pre></body></html></div>
<pre><code>## ExperimentList class object of length 5:
##  [1] RNA-Seq: matrix with 10 rows and 43 columns
##  [2] GISTIC-T: matrix with 10 rows and 43 columns
##  [3] Protein: matrix with 10 rows and 43 columns
##  [4] Mutations: matrix with 10 rows and 43 columns
##  [5] miRNA: matrix with 10 rows and 43 columns</code></pre>
<p>Note, it would be equally easy (and maybe better) to do PCA on all samples available for each assay, then do intersectColumns at this point instead.</p>
<p>Now, steps for calculating the correlations and plotting a heatmap: * Use <em>wideFormat</em> to paste these together, which has the nice property of adding assay names to the column names. * The first column always contains the sample identifier, so remove it. * Coerce to a matrix * Calculate the correlations, and take the absolute value (since signs of principal components are arbitrary) * Set the diagonals to NA (each variable has a correlation of 1 to itself).</p>
<div class="sourceCode" id="cb33"><html><body><pre class="r"><span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MultiAssayExperiment/man/MultiAssayExperiment-helpers.html">wideFormat</a></span>(<span class="no">acc2</span>)[, -<span class="fl">1</span>]
<span class="no">mycors</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="no">df</span>))
<span class="no">mycors</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(<span class="no">mycors</span>)
<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="no">mycors</span>) <span class="kw">&lt;-</span> <span class="fl">NA</span></pre></body></html></div>
<p>To simplify the heatmap, show only components that have at least one correlation greater than 0.5.</p>
<div class="sourceCode" id="cb34"><html><body><pre class="r"><span class="no">has.high.cor</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="no">mycors</span>, <span class="fl">2</span>, <span class="no">max</span>, <span class="kw">na.rm</span><span class="kw">=</span><span class="fl">TRUE</span>) <span class="kw">&gt;</span> <span class="fl">0.5</span>
<span class="no">mycors</span> <span class="kw">&lt;-</span> <span class="no">mycors</span>[<span class="no">has.high.cor</span>, <span class="no">has.high.cor</span>]

<span class="co"># colors</span>
<span class="no">mycolors</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="fl">7</span>, <span class="kw">name</span> <span class="kw">=</span> <span class="st">"Oranges"</span>))(<span class="fl">100</span>)
<span class="kw pkg">pheatmap</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html">pheatmap</a></span>(<span class="no">mycors</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="no">mycolors</span>, <span class="kw">angle_col</span> <span class="kw">=</span> <span class="fl">90</span>)</pre></body></html></div>
<p><img src="Figures5-6-S4_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<div class="sourceCode" id="cb35"><html><body><pre class="r"><span class="co"># png("FS4_pca_correls.png", width = 9, height = 8, units = "in", res = 300)</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html">pdf</a></span>(<span class="st">"pca_correls.pdf"</span>, <span class="kw">width</span> <span class="kw">=</span> <span class="fl">9</span>, <span class="kw">height</span> <span class="kw">=</span> <span class="fl">8</span>, <span class="kw">paper</span> <span class="kw">=</span> <span class="st">"special"</span>)
<span class="kw pkg">pheatmap</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html">pheatmap</a></span>(<span class="no">mycors</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="no">mycolors</span>, <span class="kw">angle_col</span> <span class="kw">=</span> <span class="fl">90</span>)
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span>()</pre></body></html></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Marcel Ramos, Levi Waldron.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
