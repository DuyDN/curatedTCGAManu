<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Figure 3 and 4 - DE / GSEA PanCan • curatedTCGAManu</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Figure 3 and 4 - DE / GSEA PanCan">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">curatedTCGAManu</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/Figure2_OncoPrint.html">PanCan OncoPrint</a>
</li>
<li>
  <a href="../articles/Figures3n4_GSEA_PanCan.html">PanCan DE &amp; GSEA</a>
</li>
<li>
  <a href="../articles/Figures5-6-S4.html">Multi-omic Plots</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/LiNk-NY/curatedTCGAManu">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Figure 3 and 4 - DE / GSEA PanCan</h1>
                        <h4 class="author">Waldron Lab</h4>
            
            <h4 class="date">March 21, 2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/LiNk-NY/curatedTCGAManu/blob/master/vignettes/Figures3n4_GSEA_PanCan.Rmd"><code>vignettes/Figures3n4_GSEA_PanCan.Rmd</code></a></small>
      <div class="hidden name"><code>Figures3n4_GSEA_PanCan.Rmd</code></div>

    </div>

    
    
<div id="dependencies" class="section level2">
<h2 class="hasAnchor">
<a href="#dependencies" class="anchor"></a>Dependencies</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(MultiAssayExperiment)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(curatedTCGAData)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(TCGAutils)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(EnrichmentBrowser)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(GSEABenchmarkeR)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(RTCGAToolbox)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(BiocParallel)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ComplexHeatmap)</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggpubr)</span></code></pre></div>
</div>
<div id="obtain-acc-data-from-curatedtcgadata" class="section level2">
<h2 class="hasAnchor">
<a href="#obtain-acc-data-from-curatedtcgadata" class="anchor"></a>Obtain ACC data from curatedTCGAData:</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"diseaseCodes"</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(avail &lt;-<span class="st"> </span>diseaseCodes[</span>
<span id="cb2-3"><a href="#cb2-3"></a>    diseaseCodes[[<span class="st">"Available"</span>]] <span class="op">==</span><span class="st"> "Yes"</span>, <span class="st">"Study.Abbreviation"</span>])</span></code></pre></div>
<pre><code>## [1] "ACC"  "BLCA" "BRCA" "CESC" "CHOL" "COAD"</code></pre>
</div>
<div id="download-and-reshape-data" class="section level2">
<h2 class="hasAnchor">
<a href="#download-and-reshape-data" class="anchor"></a>Download and reshape data</h2>
<p>Some datasets were missing normals and we suspected that there were different datasets being produced by RTCGAToolbox. Upon further inspection, TCGA provides ‘illuminaga’ and ‘illumina HiSeq’ datasets.</p>
<p>Note. First, download RTCGAToolbox from Bioc-devel and obtain correlations for samples that are in both platforms in “COAD”, “READ”, and “UCEC”.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>dl &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"COAD"</span>, <span class="st">"READ"</span>, <span class="st">"UCEC"</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a>redl &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span>(dl, dl), <span class="cf">function</span>(x) {</span>
<span id="cb4-3"><a href="#cb4-3"></a>    tx &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/RTCGAToolbox/man/getFirehoseData.html">getFirehoseData</a></span>(x, <span class="dt">RNASeq2GeneNorm =</span> <span class="ot">TRUE</span>, <span class="dt">clinical =</span> <span class="ot">FALSE</span>)</span>
<span id="cb4-4"><a href="#cb4-4"></a>    txl &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/RTCGAToolbox/man/biocExtract.html">biocExtract</a></span>(tx, <span class="st">"RNASeq2GeneNorm"</span>)</span>
<span id="cb4-5"><a href="#cb4-5"></a>    sameSamps &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/funprog.html">Reduce</a></span>(intersect, <span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(txl, colnames))</span>
<span id="cb4-6"><a href="#cb4-6"></a></span>
<span id="cb4-7"><a href="#cb4-7"></a>    <span class="co"># correlation between platforms 'illuminaga' and 'illuminahiseq'</span></span>
<span id="cb4-8"><a href="#cb4-8"></a>    <span class="kw"><a href="https://rdrr.io/r/base/message.html">message</a></span>(x)</span>
<span id="cb4-9"><a href="#cb4-9"></a>    datm &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(cbind.data.frame,</span>
<span id="cb4-10"><a href="#cb4-10"></a>        <span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(txl, <span class="cf">function</span>(g) { <span class="kw">assay</span>(g[,sameSamps]) })</span>
<span id="cb4-11"><a href="#cb4-11"></a>    )</span>
<span id="cb4-12"><a href="#cb4-12"></a>    <span class="cf">if</span> (<span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(datm))</span>
<span id="cb4-13"><a href="#cb4-13"></a>        <span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(datm[,<span class="dv">1</span>], datm[,<span class="dv">2</span>]))</span>
<span id="cb4-14"><a href="#cb4-14"></a></span>
<span id="cb4-15"><a href="#cb4-15"></a>    newassay &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="kw">assay</span>(txl[[<span class="dv">1</span>]]), <span class="kw">assay</span>(txl[[<span class="dv">2</span>]]))</span>
<span id="cb4-16"><a href="#cb4-16"></a>    newassay &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span>(newassay[, <span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/duplicated.html">duplicated</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(newassay))])</span>
<span id="cb4-17"><a href="#cb4-17"></a>    newmeta &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">metadata</span>(txl[[<span class="dv">1</span>]]), <span class="kw">metadata</span>(txl[[<span class="dv">2</span>]]))</span>
<span id="cb4-18"><a href="#cb4-18"></a>    newColData &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/MultiAssayExperiment/man/reexports.html">DataFrame</a></span>(<span class="dt">row.names =</span> <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(newassay))</span>
<span id="cb4-19"><a href="#cb4-19"></a>    <span class="kw">SummarizedExperiment</span>(<span class="dt">assays =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">TPM =</span> newassay),</span>
<span id="cb4-20"><a href="#cb4-20"></a>        <span class="dt">metadata =</span> newmeta, <span class="dt">colData =</span> newColData)</span>
<span id="cb4-21"><a href="#cb4-21"></a>    }</span>
<span id="cb4-22"><a href="#cb4-22"></a>)</span></code></pre></div>
<pre><code>## [1] 0.927677
## [1] 0.8698399</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>exper &lt;-<span class="st"> </span><span class="kw">as</span>(redl, <span class="st">"ExperimentList"</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="kw"><a href="https://rdrr.io/pkg/TCGAutils/man/curatedTCGAData-helpers.html">sampleTables</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/MultiAssayExperiment/man/MultiAssayExperiment.html">MultiAssayExperiment</a></span>(exper))</span></code></pre></div>
<pre><code>## $COAD
## 
##  01  02  06  11 
## 457   1   1  41 
## 
## $READ
## 
##  01  02  11 
## 166   1  10 
## 
## $UCEC
## 
##  01  02  11 
## 545   1  35</code></pre>
<div id="create-a-pseduo-clinical-dataframe-for-new-samples" class="section level3">
<h3 class="hasAnchor">
<a href="#create-a-pseduo-clinical-dataframe-for-new-samples" class="anchor"></a>Create a pseduo clinical DataFrame for new samples</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>allSamps &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(exper))</span>
<span id="cb8-2"><a href="#cb8-2"></a>clinphone &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/MultiAssayExperiment/man/reexports.html">DataFrame</a></span>(<span class="dt">patientID =</span> <span class="kw"><a href="https://rdrr.io/pkg/TCGAutils/man/TCGAbarcode.html">TCGAbarcode</a></span>(allSamps))</span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(clinphone) &lt;-<span class="st"> </span>clinphone[[<span class="st">"patientID"</span>]]</span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/duplicated.html">duplicated</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(clinphone)))</span></code></pre></div>
<pre><code>## [1] 77</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co">## [1] 77</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>clinphone &lt;-<span class="st"> </span>clinphone[<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/duplicated.html">duplicated</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(clinphone)), , drop =<span class="st"> </span><span class="ot">FALSE</span>]</span></code></pre></div>
</div>
<div id="combine-cancer-datasets-into-one-multiassayexperiment" class="section level3">
<h3 class="hasAnchor">
<a href="#combine-cancer-datasets-into-one-multiassayexperiment" class="anchor"></a>Combine cancer datasets into one <code>MultiAssayExperiment</code>:</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>outAssays &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"COAD_RNASeq2GeneNorm-20160128"</span>,</span>
<span id="cb11-2"><a href="#cb11-2"></a>    <span class="st">"READ_RNASeq2GeneNorm-20160128"</span>, <span class="st">"UCEC_RNASeq2GeneNorm-20160128"</span>)</span>
<span id="cb11-3"><a href="#cb11-3"></a>core &lt;-<span class="st"> </span>exper[ <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"COAD"</span>, <span class="st">"READ"</span>, <span class="st">"UCEC"</span>) ]</span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(core) &lt;-<span class="st"> </span>outAssays</span>
<span id="cb11-5"><a href="#cb11-5"></a>mapper &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/TCGAutils/man/generateMap.html">generateMap</a></span>(core, clinphone, <span class="dt">idConverter =</span> TCGAbarcode)</span>
<span id="cb11-6"><a href="#cb11-6"></a>coremae &lt;-</span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="st">    </span><span class="kw"><a href="https://rdrr.io/pkg/MultiAssayExperiment/man/MultiAssayExperiment.html">MultiAssayExperiment</a></span>(</span>
<span id="cb11-8"><a href="#cb11-8"></a>        <span class="dt">experiments =</span> core, <span class="dt">sampleMap =</span> mapper, <span class="dt">colData =</span> clinphone</span>
<span id="cb11-9"><a href="#cb11-9"></a>    )</span></code></pre></div>
</div>
</div>
<div id="pancan-rnaseq2" class="section level2">
<h2 class="hasAnchor">
<a href="#pancan-rnaseq2" class="anchor"></a>PanCan RNASeq2*</h2>
<p>Obtain the RNAseq data from <code>curatedTCGAData</code>:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>rnacomp &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/curatedTCGAData/man/curatedTCGAData.html">curatedTCGAData</a></span>(<span class="st">"*"</span>, <span class="st">"RNASeq2*"</span>, <span class="ot">FALSE</span>)</span>
<span id="cb12-2"><a href="#cb12-2"></a>rnacomp</span></code></pre></div>
<pre><code>## A MultiAssayExperiment object of 33 listed
##  experiments with user-defined names and respective classes.
##  Containing an ExperimentList class object of length 33:
##  [1] ACC_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 79 columns
##  [2] BLCA_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 427 columns
##  [3] BRCA_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 1212 columns
##  [4] CESC_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 309 columns
##  [5] CHOL_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 45 columns
##  [6] COAD_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 191 columns
##  [7] DLBC_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 48 columns
##  [8] ESCA_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 196 columns
##  [9] GBM_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 166 columns
##  [10] HNSC_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 566 columns
##  [11] KICH_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 91 columns
##  [12] KIRC_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 606 columns
##  [13] KIRP_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 323 columns
##  [14] LAML_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 173 columns
##  [15] LGG_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 530 columns
##  [16] LIHC_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 423 columns
##  [17] LUAD_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 576 columns
##  [18] LUSC_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 552 columns
##  [19] MESO_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 87 columns
##  [20] OV_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 307 columns
##  [21] PAAD_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 183 columns
##  [22] PCPG_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 187 columns
##  [23] PRAD_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 550 columns
##  [24] READ_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 72 columns
##  [25] SARC_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 265 columns
##  [26] SKCM_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 473 columns
##  [27] STAD_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 450 columns
##  [28] TGCT_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 139 columns
##  [29] THCA_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 568 columns
##  [30] THYM_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 122 columns
##  [31] UCEC_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 380 columns
##  [32] UCS_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 57 columns
##  [33] UVM_RNASeq2GeneNorm-20160128: SummarizedExperiment with 20501 rows and 80 columns
## Features:
##  experiments() - obtain the ExperimentList instance
##  colData() - the primary/phenotype DFrame
##  sampleMap() - the sample availability DFrame
##  `$`, `[`, `[[` - extract colData columns, subset, or experiment
##  *Format() - convert into a long or wide DFrame
##  assays() - convert ExperimentList to a SimpleList of matrices</code></pre>
<p>Replace above processed datasets in the full RNASeq <code>MultiAssayExperiment</code>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>rnacopy &lt;-<span class="st"> </span>rnacomp</span>
<span id="cb14-2"><a href="#cb14-2"></a>rnacomp &lt;-<span class="st"> </span>rnacomp[, , <span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(rnacomp) <span class="op">%in%</span><span class="st"> </span>outAssays]</span></code></pre></div>
<pre><code>## harmonizing input:
##   removing 643 sampleMap rows not in names(experiments)
##   removing 633 colData rownames not in sampleMap 'primary'</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>rnacomp &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(rnacomp, coremae)</span></code></pre></div>
<p>Here we check for the samples of interest using <code>sampleTables</code>:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw"><a href="https://rdrr.io/pkg/TCGAutils/man/curatedTCGAData-helpers.html">sampleTables</a></span>(rnacomp)</span></code></pre></div>
<pre><code>## $`ACC_RNASeq2GeneNorm-20160128`
## 
## 01 
## 79 
## 
## $`BLCA_RNASeq2GeneNorm-20160128`
## 
##  01  11 
## 408  19 
## 
## $`BRCA_RNASeq2GeneNorm-20160128`
## 
##   01   06   11 
## 1093    7  112 
## 
## $`CESC_RNASeq2GeneNorm-20160128`
## 
##  01  06  11 
## 304   2   3 
## 
## $`CHOL_RNASeq2GeneNorm-20160128`
## 
## 01 11 
## 36  9 
## 
## $`DLBC_RNASeq2GeneNorm-20160128`
## 
## 01 
## 48 
## 
## $`ESCA_RNASeq2GeneNorm-20160128`
## 
##  01  06  11 
## 184   1  11 
## 
## $`GBM_RNASeq2GeneNorm-20160128`
## 
##  01  02 
## 153  13 
## 
## $`HNSC_RNASeq2GeneNorm-20160128`
## 
##  01  06  11 
## 520   2  44 
## 
## $`KICH_RNASeq2GeneNorm-20160128`
## 
## 01 11 
## 66 25 
## 
## $`KIRC_RNASeq2GeneNorm-20160128`
## 
##  01  05  11 
## 533   1  72 
## 
## $`KIRP_RNASeq2GeneNorm-20160128`
## 
##  01  05  11 
## 290   1  32 
## 
## $`LAML_RNASeq2GeneNorm-20160128`
## 
##  03 
## 173 
## 
## $`LGG_RNASeq2GeneNorm-20160128`
## 
##  01  02 
## 516  14 
## 
## $`LIHC_RNASeq2GeneNorm-20160128`
## 
##  01  02  11 
## 371   2  50 
## 
## $`LUAD_RNASeq2GeneNorm-20160128`
## 
##  01  02  11 
## 515   2  59 
## 
## $`LUSC_RNASeq2GeneNorm-20160128`
## 
##  01  11 
## 501  51 
## 
## $`MESO_RNASeq2GeneNorm-20160128`
## 
## 01 
## 87 
## 
## $`OV_RNASeq2GeneNorm-20160128`
## 
##  01  02 
## 303   4 
## 
## $`PAAD_RNASeq2GeneNorm-20160128`
## 
##  01  06  11 
## 178   1   4 
## 
## $`PCPG_RNASeq2GeneNorm-20160128`
## 
##  01  05  06  11 
## 179   3   2   3 
## 
## $`PRAD_RNASeq2GeneNorm-20160128`
## 
##  01  06  11 
## 497   1  52 
## 
## $`SARC_RNASeq2GeneNorm-20160128`
## 
##  01  02  06  11 
## 259   3   1   2 
## 
## $`SKCM_RNASeq2GeneNorm-20160128`
## 
##  01  06  07  11 
## 103 368   1   1 
## 
## $`STAD_RNASeq2GeneNorm-20160128`
## 
##  01  11 
## 415  35 
## 
## $`TGCT_RNASeq2GeneNorm-20160128`
## 
##  01  05 
## 134   5 
## 
## $`THCA_RNASeq2GeneNorm-20160128`
## 
##  01  06  11 
## 501   8  59 
## 
## $`THYM_RNASeq2GeneNorm-20160128`
## 
##  01  11 
## 120   2 
## 
## $`UCS_RNASeq2GeneNorm-20160128`
## 
## 01 
## 57 
## 
## $`UVM_RNASeq2GeneNorm-20160128`
## 
## 01 
## 80 
## 
## $`COAD_RNASeq2GeneNorm-20160128`
## 
##  01  02  06  11 
## 457   1   1  41 
## 
## $`READ_RNASeq2GeneNorm-20160128`
## 
##  01  02  11 
## 166   1  10 
## 
## $`UCEC_RNASeq2GeneNorm-20160128`
## 
##  01  02  11 
## 545   1  35</code></pre>
<p>Which cancer codes have both tumors and normal samples?</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>okCA &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">vapply</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/TCGAutils/man/curatedTCGAData-helpers.html">sampleTables</a></span>(rnacomp),</span>
<span id="cb19-2"><a href="#cb19-2"></a>    <span class="cf">function</span>(x) {</span>
<span id="cb19-3"><a href="#cb19-3"></a>        <span class="kw"><a href="https://rdrr.io/r/base/all.html">all</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"01"</span>, <span class="st">"11"</span>) <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(x))</span>
<span id="cb19-4"><a href="#cb19-4"></a>    },</span>
<span id="cb19-5"><a href="#cb19-5"></a>    <span class="kw"><a href="https://rdrr.io/r/base/logical.html">logical</a></span>(1L)</span>
<span id="cb19-6"><a href="#cb19-6"></a>)</span>
<span id="cb19-7"><a href="#cb19-7"></a></span>
<span id="cb19-8"><a href="#cb19-8"></a>(</span>
<span id="cb19-9"><a href="#cb19-9"></a>okCodes &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">vapply</a></span>(</span>
<span id="cb19-10"><a href="#cb19-10"></a>    <span class="kw"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(okCA)), <span class="st">"_"</span>),</span>
<span id="cb19-11"><a href="#cb19-11"></a>    <span class="st">`</span><span class="dt">[</span><span class="st">`</span>,</span>
<span id="cb19-12"><a href="#cb19-12"></a>    <span class="kw"><a href="https://rdrr.io/r/base/character.html">character</a></span>(1L),</span>
<span id="cb19-13"><a href="#cb19-13"></a>    1L)</span>
<span id="cb19-14"><a href="#cb19-14"></a>)</span></code></pre></div>
<pre><code>##  [1] "BLCA" "BRCA" "CESC" "CHOL" "ESCA" "HNSC" "KICH" "KIRC" "KIRP" "LIHC"
## [11] "LUAD" "LUSC" "PAAD" "PCPG" "PRAD" "SARC" "SKCM" "STAD" "THCA" "THYM"
## [21] "COAD" "READ" "UCEC"</code></pre>
<p>Assemble appropriate <code>MultiAssayExperiment</code> object with cancer codes that have both tumors and normals.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>rnacomp2 &lt;-<span class="st"> </span>rnacomp[ , , okCA]</span></code></pre></div>
<pre><code>## harmonizing input:
##   removing 1666 sampleMap rows not in names(experiments)
##   removing 1638 colData rownames not in sampleMap 'primary'</code></pre>
<p>Isolate tumor and normal samples for each cancer that have more than 10 samples of each:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>selects &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/TCGAutils/man/TCGAsampleSelect.html">TCGAsampleSelect</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(rnacomp2), <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"01"</span>, <span class="st">"11"</span>))</span>
<span id="cb23-2"><a href="#cb23-2"></a></span>
<span id="cb23-3"><a href="#cb23-3"></a>rnacomp3 &lt;-<span class="st"> </span>rnacomp2[, selects]</span></code></pre></div>
<pre><code>## harmonizing input:
##   removing 410 sampleMap rows with 'colname' not in colnames of experiments
##   removing 365 colData rownames not in sampleMap 'primary'</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>enoughNorm &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">vapply</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/TCGAutils/man/curatedTCGAData-helpers.html">sampleTables</a></span>(rnacomp3),</span>
<span id="cb25-2"><a href="#cb25-2"></a>    <span class="cf">function</span>(samp) { samp[<span class="st">"11"</span>] <span class="op">&gt;=</span><span class="st"> </span>10L }, <span class="kw"><a href="https://rdrr.io/r/base/logical.html">logical</a></span>(1L))</span>
<span id="cb25-3"><a href="#cb25-3"></a></span>
<span id="cb25-4"><a href="#cb25-4"></a>rnacomp4 &lt;-<span class="st"> </span>rnacomp3[, , enoughNorm]</span></code></pre></div>
<pre><code>## harmonizing input:
##   removing 1203 sampleMap rows not in names(experiments)
##   removing 1180 colData rownames not in sampleMap 'primary'</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="kw"><a href="https://rdrr.io/pkg/TCGAutils/man/curatedTCGAData-helpers.html">sampleTables</a></span>(rnacomp4)</span></code></pre></div>
<pre><code>## $`BLCA_RNASeq2GeneNorm-20160128`
## 
##  01  11 
## 408  19 
## 
## $`BRCA_RNASeq2GeneNorm-20160128`
## 
##   01   11 
## 1093  112 
## 
## $`ESCA_RNASeq2GeneNorm-20160128`
## 
##  01  11 
## 184  11 
## 
## $`HNSC_RNASeq2GeneNorm-20160128`
## 
##  01  11 
## 520  44 
## 
## $`KICH_RNASeq2GeneNorm-20160128`
## 
## 01 11 
## 66 25 
## 
## $`KIRC_RNASeq2GeneNorm-20160128`
## 
##  01  11 
## 533  72 
## 
## $`KIRP_RNASeq2GeneNorm-20160128`
## 
##  01  11 
## 290  32 
## 
## $`LIHC_RNASeq2GeneNorm-20160128`
## 
##  01  11 
## 371  50 
## 
## $`LUAD_RNASeq2GeneNorm-20160128`
## 
##  01  11 
## 515  59 
## 
## $`LUSC_RNASeq2GeneNorm-20160128`
## 
##  01  11 
## 501  51 
## 
## $`PRAD_RNASeq2GeneNorm-20160128`
## 
##  01  11 
## 497  52 
## 
## $`STAD_RNASeq2GeneNorm-20160128`
## 
##  01  11 
## 415  35 
## 
## $`THCA_RNASeq2GeneNorm-20160128`
## 
##  01  11 
## 501  59 
## 
## $`COAD_RNASeq2GeneNorm-20160128`
## 
##  01  11 
## 457  41 
## 
## $`READ_RNASeq2GeneNorm-20160128`
## 
##  01  11 
## 166  10 
## 
## $`UCEC_RNASeq2GeneNorm-20160128`
## 
##  01  11 
## 545  35</code></pre>
<p>Create an index to annotate each of the <code>SummarizedExperiment</code> objects contained in the <code>ExperimentList</code>:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>tlogic &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/TCGAutils/man/TCGAsampleSelect.html">TCGAsampleSelect</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(rnacomp4), <span class="st">"01"</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a>sampIndx &lt;-<span class="st"> </span><span class="kw">IntegerList</span>(<span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(tlogic, ifelse, 1L, 0L))</span>
<span id="cb29-3"><a href="#cb29-3"></a></span>
<span id="cb29-4"><a href="#cb29-4"></a>naks &lt;-<span class="st"> </span><span class="kw">mendoapply</span>(<span class="cf">function</span>(x, y) {</span>
<span id="cb29-5"><a href="#cb29-5"></a>    <span class="kw">colData</span>(x)[[<span class="st">"GROUP"</span>]] &lt;-<span class="st"> </span>y</span>
<span id="cb29-6"><a href="#cb29-6"></a>    <span class="kw">colData</span>(x)[[<span class="st">"BLOCK"</span>]] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/TCGAutils/man/TCGAbarcode.html">TCGAbarcode</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="kw">colData</span>(x)))</span>
<span id="cb29-7"><a href="#cb29-7"></a>    x</span>
<span id="cb29-8"><a href="#cb29-8"></a>}, <span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/pkg/MultiAssayExperiment/man/MultiAssayExperiment-methods.html">experiments</a></span>(rnacomp4), <span class="dt">y =</span> sampIndx)</span>
<span id="cb29-9"><a href="#cb29-9"></a></span>
<span id="cb29-10"><a href="#cb29-10"></a>rnacomp5 &lt;-<span class="st"> </span>BiocGenerics<span class="op">:::</span><span class="kw">replaceSlots</span>(rnacomp4,</span>
<span id="cb29-11"><a href="#cb29-11"></a>    <span class="dt">ExperimentList =</span> naks,</span>
<span id="cb29-12"><a href="#cb29-12"></a>    <span class="dt">check =</span> <span class="ot">FALSE</span>)</span>
<span id="cb29-13"><a href="#cb29-13"></a></span>
<span id="cb29-14"><a href="#cb29-14"></a><span class="kw"><a href="https://rdrr.io/r/base/table.html">table</a></span>(rnacomp5[[1L]]<span class="op">$</span>GROUP)</span></code></pre></div>
<pre><code>## 
##   0   1 
##  19 408</code></pre>
<p>Split, create matched tumors and normals, and then recombine into a single <code>MultiAssayExperiment</code>:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>matchlist &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(rnacomp5), <span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(rnacomp5)),</span>
<span id="cb31-2"><a href="#cb31-2"></a>    <span class="cf">function</span>(idx) {</span>
<span id="cb31-3"><a href="#cb31-3"></a>        <span class="kw">as</span>(<span class="kw"><a href="https://rdrr.io/pkg/TCGAutils/man/curatedTCGAData-helpers.html">splitAssays</a></span>(rnacomp5[, , idx]), <span class="st">"MatchedAssayExperiment"</span>)</span>
<span id="cb31-4"><a href="#cb31-4"></a>    }</span>
<span id="cb31-5"><a href="#cb31-5"></a>)</span>
<span id="cb31-6"><a href="#cb31-6"></a>newEXPS &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/MultiAssayExperiment/man/ExperimentList.html">ExperimentList</a></span>(</span>
<span id="cb31-7"><a href="#cb31-7"></a>    <span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(matchlist, <span class="cf">function</span>(expr) {</span>
<span id="cb31-8"><a href="#cb31-8"></a>        <span class="kw"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(cbind, <span class="kw"><a href="https://rdrr.io/pkg/MultiAssayExperiment/man/MultiAssayExperiment-methods.html">experiments</a></span>(expr))</span>
<span id="cb31-9"><a href="#cb31-9"></a>    })</span>
<span id="cb31-10"><a href="#cb31-10"></a>)</span>
<span id="cb31-11"><a href="#cb31-11"></a></span>
<span id="cb31-12"><a href="#cb31-12"></a>rnacomp6 &lt;-<span class="st"> </span>BiocGenerics<span class="op">:::</span><span class="kw">replaceSlots</span>(rnacomp5,</span>
<span id="cb31-13"><a href="#cb31-13"></a>    <span class="dt">ExperimentList =</span> newEXPS,</span>
<span id="cb31-14"><a href="#cb31-14"></a>    <span class="dt">check =</span> <span class="ot">FALSE</span></span>
<span id="cb31-15"><a href="#cb31-15"></a>)</span></code></pre></div>
<p>Save point:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/MultiAssayExperiment/man/MultiAssayExperiment-methods.html">experiments</a></span>(rnacomp6), <span class="dt">file =</span> <span class="st">"../inst/data/pancan_exprs.rds"</span>)</span>
<span id="cb32-2"><a href="#cb32-2"></a>r6ex &lt;-<span class="st"> </span><span class="kw">loadRDS</span>(<span class="dt">file =</span> <span class="st">"../inst/data/pancan_exprs.rds"</span>)</span></code></pre></div>
<p>Differential Expression analysis:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>exp.list &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/MultiAssayExperiment/man/MultiAssayExperiment-methods.html">experiments</a></span>(rnacomp6)</span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(exp.list) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/substr.html">substring</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(exp.list), <span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb33-3"><a href="#cb33-3"></a>exp.list &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(exp.list,</span>
<span id="cb33-4"><a href="#cb33-4"></a>    <span class="cf">function</span>(se)</span>
<span id="cb33-5"><a href="#cb33-5"></a>    {</span>
<span id="cb33-6"><a href="#cb33-6"></a>        <span class="co"># if assay is matrix: assay(se) &lt;- log(assay(se) + 1, base=2)</span></span>
<span id="cb33-7"><a href="#cb33-7"></a>        <span class="kw">assays</span>(se) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">TPM=</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="kw">assay</span>(se)) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">base=</span><span class="dv">2</span>))</span>
<span id="cb33-8"><a href="#cb33-8"></a>        <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(se)</span>
<span id="cb33-9"><a href="#cb33-9"></a>    })</span>
<span id="cb33-10"><a href="#cb33-10"></a>exp.list &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/GSEABenchmarkeR/man/runDE.html">runDE</a></span>(exp.list)</span>
<span id="cb33-11"><a href="#cb33-11"></a><span class="co"># for(n in names(exp.list)) saveRDS(exp.list[[n]], file = paste(n, "rds", sep="."))</span></span></code></pre></div>
<div id="figure-3-boxplot" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-3-boxplot" class="anchor"></a>Figure 3 BoxPlot</h3>
<p>Extract genes with consistent expression changes:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>wfcs &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/GSEABenchmarkeR/man/runDE.html">metaFC</a></span>(exp.list, <span class="dt">max.na=</span><span class="dv">3</span>)</span>
<span id="cb34-2"><a href="#cb34-2"></a></span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="co"># Heatmap</span></span>
<span id="cb34-4"><a href="#cb34-4"></a>top.wfcs.genes &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(wfcs)[<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>]</span>
<span id="cb34-5"><a href="#cb34-5"></a>extractFC &lt;-<span class="st"> </span><span class="cf">function</span>(exp.list, top.wfcs.genes)</span>
<span id="cb34-6"><a href="#cb34-6"></a>{</span>
<span id="cb34-7"><a href="#cb34-7"></a>    fcs &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">vapply</a></span>(exp.list,</span>
<span id="cb34-8"><a href="#cb34-8"></a>        <span class="cf">function</span>(d) <span class="kw">rowData</span>(d)[top.wfcs.genes, <span class="st">"FC"</span>],</span>
<span id="cb34-9"><a href="#cb34-9"></a>        <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(top.wfcs.genes)))</span>
<span id="cb34-10"><a href="#cb34-10"></a>    <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(fcs) &lt;-<span class="st"> </span>top.wfcs.genes</span>
<span id="cb34-11"><a href="#cb34-11"></a>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(fcs)</span>
<span id="cb34-12"><a href="#cb34-12"></a>}</span>
<span id="cb34-13"><a href="#cb34-13"></a>fcs &lt;-<span class="st"> </span><span class="kw">extractFC</span>(exp.list, top.wfcs.genes)</span>
<span id="cb34-14"><a href="#cb34-14"></a></span>
<span id="cb34-15"><a href="#cb34-15"></a><span class="co"># pdf("log2fc.pdf", paper = "special", width = 8, height = 12)</span></span>
<span id="cb34-16"><a href="#cb34-16"></a><span class="kw"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html">Heatmap</a></span>(fcs, <span class="dt">name=</span><span class="st">"log2FC"</span>, <span class="dt">show_row_names=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="Figures3n4_GSEA_PanCan_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co"># dev.off()</span></span></code></pre></div>
</div>
</div>
<div id="figure-3" class="section level2">
<h2 class="hasAnchor">
<a href="#figure-3" class="anchor"></a>Figure 3</h2>
<div id="pan-cancer-differential-expression-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#pan-cancer-differential-expression-analysis" class="anchor"></a>Pan-cancer differential expression analysis</h3>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="co"># Boxplot</span></span>
<span id="cb36-2"><a href="#cb36-2"></a>top.wfcs.genes &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(wfcs[wfcs <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>][<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>], wfcs[wfcs <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>][<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>]))</span>
<span id="cb36-3"><a href="#cb36-3"></a>fcs &lt;-<span class="st"> </span><span class="kw">extractFC</span>(exp.list, top.wfcs.genes)</span>
<span id="cb36-4"><a href="#cb36-4"></a>df &lt;-<span class="st"> </span>reshape2<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span>(fcs)</span>
<span id="cb36-5"><a href="#cb36-5"></a>medians &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(fcs, <span class="dv">1</span>, median, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</span>
<span id="cb36-6"><a href="#cb36-6"></a>o &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(medians))</span>
<span id="cb36-7"><a href="#cb36-7"></a>p &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/ggpubr/man/ggboxplot.html">ggboxplot</a></span>(df, <span class="dt">x =</span> <span class="st">"Var1"</span>, <span class="dt">y =</span> <span class="st">"value"</span>, <span class="dt">width =</span> <span class="fl">0.8</span>,</span>
<span id="cb36-8"><a href="#cb36-8"></a>    <span class="dt">ylab=</span><span class="st">"log2 fold change"</span>, <span class="dt">xlab=</span><span class="st">""</span>, <span class="dt">order=</span>o, <span class="dt">color=</span><span class="st">"Var1"</span>, <span class="dt">add =</span><span class="st">"jitter"</span>)</span>
<span id="cb36-9"><a href="#cb36-9"></a>p &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/ggpubr/man/ggpar.html">ggpar</a></span>(p, <span class="dt">x.text.angle=</span><span class="dv">45</span>, <span class="dt">palette =</span> <span class="st">"simpsons"</span>, <span class="dt">legend=</span><span class="st">"none"</span>)</span>
<span id="cb36-10"><a href="#cb36-10"></a>gg &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span><span class="dv">0</span>, <span class="dt">linetype=</span><span class="st">"dashed"</span>, <span class="dt">color =</span> <span class="st">"darkgrey"</span>) <span class="op">+</span></span>
<span id="cb36-11"><a href="#cb36-11"></a><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span><span class="fl">8.5</span>, <span class="dt">linetype=</span><span class="st">"dashed"</span>, <span class="dt">color =</span> <span class="st">"darkgrey"</span>)</span>
<span id="cb36-12"><a href="#cb36-12"></a>gg</span></code></pre></div>
<p><img src="Figures3n4_GSEA_PanCan_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<p>ggsaving…</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="kw">ggsave</span>(<span class="st">"boxplot_pancan.svg"</span>, gg, <span class="dt">device =</span> <span class="st">"svg"</span>)</span>
<span id="cb37-2"><a href="#cb37-2"></a></span>
<span id="cb37-3"><a href="#cb37-3"></a><span class="co">## pdf</span></span>
<span id="cb37-4"><a href="#cb37-4"></a><span class="kw">ggsave</span>(<span class="st">"boxplot_pancan.pdf"</span>, gg, <span class="dt">device =</span> <span class="st">"pdf"</span>)</span></code></pre></div>
</div>
</div>
<div id="gsea" class="section level1">
<h1 class="hasAnchor">
<a href="#gsea" class="anchor"></a>GSEA</h1>
<p>ID mapping</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>exp.list &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(exp.list,</span>
<span id="cb38-2"><a href="#cb38-2"></a>    <span class="cf">function</span>(se) <span class="kw"><a href="https://rdrr.io/pkg/EnrichmentBrowser/man/idMap.html">idMap</a></span>(se, <span class="dt">org=</span><span class="st">"hsa"</span>, <span class="dt">from=</span><span class="st">"SYMBOL"</span>, <span class="dt">to=</span><span class="st">"ENTREZID"</span>))</span></code></pre></div>
<p>Obtain gene sets</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>go.gs &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/EnrichmentBrowser/man/getGenesets.html">getGenesets</a></span>(<span class="dt">org=</span><span class="st">"hsa"</span>, <span class="dt">db=</span><span class="st">"go"</span>)</span></code></pre></div>
<pre><code>## </code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>ids &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">vapply</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(go.gs), <span class="cf">function</span>(n) <span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span>(n, <span class="st">"_"</span>))[<span class="dv">1</span>], <span class="kw"><a href="https://rdrr.io/r/base/character.html">character</a></span>(<span class="dv">1</span>))</span>
<span id="cb41-2"><a href="#cb41-2"></a>ids &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/grep.html">sub</a></span>(<span class="st">":"</span>, <span class="st">""</span>, ids)</span>
<span id="cb41-3"><a href="#cb41-3"></a>extractTitle &lt;-<span class="st"> </span><span class="cf">function</span>(n)</span>
<span id="cb41-4"><a href="#cb41-4"></a>{</span>
<span id="cb41-5"><a href="#cb41-5"></a>    spl &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span>(n, <span class="st">"_"</span>))[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb41-6"><a href="#cb41-6"></a>    <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(spl, <span class="dt">collapse =</span> <span class="st">" "</span>)</span>
<span id="cb41-7"><a href="#cb41-7"></a>}</span>
<span id="cb41-8"><a href="#cb41-8"></a>go.i2n &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">vapply</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(go.gs), extractTitle, <span class="kw"><a href="https://rdrr.io/r/base/character.html">character</a></span>(<span class="dv">1</span>))</span>
<span id="cb41-9"><a href="#cb41-9"></a><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(go.i2n) &lt;-<span class="st"> </span>ids</span></code></pre></div>
<p>Execute ORA (has been pre-computed on a cluster, skip this step):</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>res &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/GSEABenchmarkeR/man/runEA.html">runEA</a></span>(exp.list, <span class="dt">methods=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"ora"</span>, <span class="st">"padog"</span>),</span>
<span id="cb42-2"><a href="#cb42-2"></a>    <span class="dt">gs=</span>go.gs, <span class="dt">perm=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">1000</span>), <span class="dt">save2file=</span><span class="ot">TRUE</span>, <span class="dt">out.dir=</span><span class="st">"../inst/data"</span>)</span></code></pre></div>
<p>Read pre-computed results for ORA and PADOG for GO-BP gene sets</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>res &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/GSEABenchmarkeR/man/readResults.html">readResults</a></span>(<span class="dt">data.dir=</span><span class="st">"../inst/data"</span>, <span class="dt">data.ids=</span><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(exp.list),</span>
<span id="cb43-2"><a href="#cb43-2"></a>    <span class="dt">methods=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"ora"</span>, <span class="st">"padog"</span>), <span class="dt">type=</span><span class="st">"ranking"</span>)</span></code></pre></div>
<p>Determine enrichment across datasets:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>isEnriched &lt;-<span class="st"> </span><span class="cf">function</span>(res, <span class="dt">pthresh=</span><span class="fl">0.05</span>, <span class="dt">nr.top=</span><span class="dv">1</span><span class="op">:</span><span class="dv">15</span>)</span>
<span id="cb44-2"><a href="#cb44-2"></a>{</span>
<span id="cb44-3"><a href="#cb44-3"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(res)) <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(res[[i]]) &lt;-<span class="st"> </span>res[[i]]<span class="op">$</span>GENE.SET</span>
<span id="cb44-4"><a href="#cb44-4"></a>    pmat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">vapply</a></span>(res, <span class="cf">function</span>(r) r[<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(res[[<span class="dv">1</span>]]), <span class="st">"PVAL"</span>], res[[<span class="dv">1</span>]]<span class="op">$</span>PVAL)</span>
<span id="cb44-5"><a href="#cb44-5"></a>    <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(pmat) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(res[[<span class="dv">1</span>]])</span>
<span id="cb44-6"><a href="#cb44-6"></a>    is.enriched &lt;-<span class="st"> </span>pmat <span class="op">&lt;</span><span class="st"> </span>pthresh</span>
<span id="cb44-7"><a href="#cb44-7"></a>    rse &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span>(is.enriched)</span>
<span id="cb44-8"><a href="#cb44-8"></a></span>
<span id="cb44-9"><a href="#cb44-9"></a>    top.gs &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(rse, <span class="dt">decreasing=</span><span class="ot">TRUE</span>)[nr.top])</span>
<span id="cb44-10"><a href="#cb44-10"></a>    top.mat &lt;-<span class="st"> </span>is.enriched[top.gs,]</span>
<span id="cb44-11"><a href="#cb44-11"></a>    <span class="kw"><a href="https://rdrr.io/r/base/mode.html">mode</a></span>(top.mat) &lt;-<span class="st"> "integer"</span></span>
<span id="cb44-12"><a href="#cb44-12"></a>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(top.mat)</span>
<span id="cb44-13"><a href="#cb44-13"></a>}</span>
<span id="cb44-14"><a href="#cb44-14"></a></span>
<span id="cb44-15"><a href="#cb44-15"></a>go.ora &lt;-<span class="st"> </span><span class="kw">isEnriched</span>(res<span class="op">$</span>ora)</span>
<span id="cb44-16"><a href="#cb44-16"></a>go.padog &lt;-<span class="st"> </span><span class="kw">isEnriched</span>(res<span class="op">$</span>padog, <span class="dt">nr.top=</span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(go.ora))</span>
<span id="cb44-17"><a href="#cb44-17"></a></span>
<span id="cb44-18"><a href="#cb44-18"></a><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(go.ora) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(go.padog) &lt;-<span class="st"> </span>go.i2n[<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(go.ora)]</span>
<span id="cb44-19"><a href="#cb44-19"></a>extract &lt;-<span class="st"> </span><span class="cf">function</span>(n, ind) <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span>(n, <span class="st">" "</span>))[ind], <span class="dt">collapse =</span> <span class="st">" "</span>)</span>
<span id="cb44-20"><a href="#cb44-20"></a><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(go.ora)[<span class="dv">4</span>] &lt;-<span class="st"> </span><span class="kw">extract</span>(<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(go.ora)[<span class="dv">4</span>], <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)</span>
<span id="cb44-21"><a href="#cb44-21"></a><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(go.ora)[<span class="dv">10</span>] &lt;-<span class="st"> </span><span class="kw">extract</span>(<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(go.ora)[<span class="dv">10</span>], <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">4</span>))</span>
<span id="cb44-22"><a href="#cb44-22"></a><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(go.ora)[<span class="dv">11</span>] &lt;-<span class="st"> </span><span class="kw">extract</span>(<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(go.ora)[<span class="dv">11</span>], <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)</span>
<span id="cb44-23"><a href="#cb44-23"></a><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(go.ora)[<span class="dv">15</span>] &lt;-<span class="st"> </span><span class="kw">extract</span>(<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(go.ora)[<span class="dv">15</span>], <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb44-24"><a href="#cb44-24"></a></span>
<span id="cb44-25"><a href="#cb44-25"></a><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(go.padog) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(go.ora)</span></code></pre></div>
<div id="figure-4" class="section level2">
<h2 class="hasAnchor">
<a href="#figure-4" class="anchor"></a>Figure 4</h2>
<div id="pan-cancer-gene-set-enrichment-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#pan-cancer-gene-set-enrichment-analysis" class="anchor"></a>Pan-cancer gene set enrichment analysis</h3>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>h1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html">Heatmap</a></span>(go.ora, <span class="dt">cluster_rows=</span><span class="ot">FALSE</span>, <span class="dt">cluster_columns=</span><span class="ot">FALSE</span>,</span>
<span id="cb45-2"><a href="#cb45-2"></a>    <span class="dt">show_row_names=</span><span class="ot">FALSE</span>, <span class="dt">show_heatmap_legend =</span> <span class="ot">FALSE</span>,</span>
<span id="cb45-3"><a href="#cb45-3"></a>    <span class="dt">col=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"white"</span>, <span class="st">"black"</span>), <span class="dt">column_title=</span><span class="st">"ORA p &lt; 0.05"</span>,</span>
<span id="cb45-4"><a href="#cb45-4"></a>    <span class="dt">row_names_gp =</span> <span class="kw">gpar</span>(<span class="dt">fontsize =</span> <span class="dv">11</span>))</span>
<span id="cb45-5"><a href="#cb45-5"></a>h2 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html">Heatmap</a></span>(go.padog, <span class="dt">cluster_rows=</span><span class="ot">FALSE</span>, <span class="dt">cluster_columns=</span><span class="ot">FALSE</span>,</span>
<span id="cb45-6"><a href="#cb45-6"></a>    <span class="dt">show_row_names=</span><span class="ot">TRUE</span>, <span class="dt">show_heatmap_legend =</span> <span class="ot">FALSE</span>,</span>
<span id="cb45-7"><a href="#cb45-7"></a>    <span class="dt">col=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"white"</span>, <span class="st">"black"</span>), <span class="dt">column_title=</span><span class="st">"PADOG p &lt; 0.05"</span>,</span>
<span id="cb45-8"><a href="#cb45-8"></a>    <span class="dt">row_names_gp =</span> <span class="kw">gpar</span>(<span class="dt">fontsize =</span> <span class="dv">11</span>))</span>
<span id="cb45-9"><a href="#cb45-9"></a>hl &lt;-<span class="st"> </span>h1 <span class="op">+</span><span class="st"> </span>h2</span>
<span id="cb45-10"><a href="#cb45-10"></a><span class="kw"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html">draw</a></span>(hl, <span class="dt">ht_gap =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>))</span></code></pre></div>
<p><img src="Figures3n4_GSEA_PanCan_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
<p>Code for saving to PDF:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="kw"><a href="https://rdrr.io/r/grDevices/pdf.html">pdf</a></span>(<span class="st">"orapadog.pdf"</span>, <span class="dt">paper =</span> <span class="st">"special"</span>, <span class="dt">width =</span> <span class="dv">12</span>, <span class="dt">height =</span> <span class="dv">8</span>)</span>
<span id="cb46-2"><a href="#cb46-2"></a><span class="kw"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html">draw</a></span>(hl, <span class="dt">ht_gap =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>))</span>
<span id="cb46-3"><a href="#cb46-3"></a><span class="kw"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span>()</span></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#dependencies">Dependencies</a></li>
      <li><a href="#obtain-acc-data-from-curatedtcgadata">Obtain ACC data from curatedTCGAData:</a></li>
      <li><a href="#download-and-reshape-data">Download and reshape data</a></li>
      <li><a href="#pancan-rnaseq2">PanCan RNASeq2*</a></li>
      <li><a href="#figure-3">Figure 3</a></li>
      <li>
<a href="#gsea">GSEA</a><ul class="nav nav-pills nav-stacked">
<li><a href="#figure-4">Figure 4</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Marcel Ramos, Levi Waldron.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
